{% load static %}
{% load search_extra %}

<html lang="en">
<head>

	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
	
	<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
	<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<!------ Include the above in your HEAD tag ---------->

	<title>Scatter Chart</title>
	<script src={% static "js/chart.js" %}></script>
	<script src={% static "js/chart_utils.js" %}></script>

		<style>
	canvas {
		-moz-user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}
	</style>

</head>
<body>
	<div style="width:75%">
		<canvas id="canvas"></canvas>
	</div>
	<button id="randomizeData">Randomize Data</button>
	<script>
		var color = Chart.helpers.color;
		var top_freq = {{ top_freq|escapejs}}
		var other_freq = {{ other_freq|escapejs }}

		function generateData(par) {
			var data = [];
			
			data.push({
				x: par,
				y: top_freq[par]
			});
			
			return data;
		}
		
		function generateOtherData() {
			var data = [];
			
			for (var i = 0; i < 1000; i++){
				data.push({
					x: i+100,
					y: other_freq[i]
				});
			}
			return data;
			
		}
		
		function getDataSet() {
			var dataset = [];
			for (var i = 0; i < 100 ; i++){
				dataset.push({label: i,
							backgroundColor: getRandomColor(),
							data: generateData(i)})
			}
			
			dataset.push({label: "other",
				backgroundColor: getRandomColor(),
				data: generateOtherData() })
			return dataset;
		}
		
		function getRandomColor() {
			var letters = '0123456789ABCDEF'.split('');
			var color = '#';
			for (var i = 0; i < 6; i++ ) {
				color += letters[Math.floor(Math.random() * 16)];
			}
			return color;
		}
		

		var scatterChartData = {
			datasets : getDataSet(),
		};

		window.onload = function() {
			var ctx = document.getElementById('canvas').getContext('2d');
			window.myScatter = Chart.Scatter(ctx, {
				data: scatterChartData,
				options: {
					title: {
						display: true,
						text: 'Chart.js Scatter Chart'
					},
				}
			});
		};

		document.getElementById('randomizeData').addEventListener('click', function() {
			scatterChartData.datasets.forEach(function(dataset) {
				dataset.data = dataset.data.map(function() {
					return {
						x: randomScalingFactor(),
						y: randomScalingFactor()
					};
				});
			});
			window.myScatter.update();
		});
	</script>

	<table class="table">
		<thead>
			<tr>
			<th scope="col">#</th>
			<th scope="col">Word</th>
			<th scope="col">Frequency</th>
			</tr>
		</thead>
		<tbody>
			{% for i in top_words %}
			<tr>
			<th scope="row">{{ forloop.counter }}</th>
				<td>{{ i }}</td>
				<td>{{ top_freq|get_element:forloop.counter0 }}</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
	
</body>
</html>
